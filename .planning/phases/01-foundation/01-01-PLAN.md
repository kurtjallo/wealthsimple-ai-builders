---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - next.config.ts
  - tailwind.config.ts
  - postcss.config.mjs
  - components.json
  - .env.local
  - .env.example
  - .gitignore
  - src/app/layout.tsx
  - src/app/page.tsx
  - src/app/globals.css
  - src/lib/utils.ts
  - src/components/ui/button.tsx
  - src/components/ui/card.tsx
  - src/components/ui/badge.tsx
  - src/components/ui/input.tsx
  - src/types/index.ts
autonomous: true

must_haves:
  truths:
    - "Next.js dev server starts with `npm run dev` and shows the app shell at localhost:3000"
    - "All core dependencies installed (next, react, supabase-js, @anthropic-ai/sdk, shadcn components)"
    - "Project structure has src/app, src/components, src/lib, src/types directories"
    - "TypeScript compiles with no errors"
  artifacts:
    - path: "package.json"
      provides: "All project dependencies and scripts"
      contains: "next"
    - path: "src/app/layout.tsx"
      provides: "Root layout with metadata"
      contains: "RootLayout"
    - path: "src/app/page.tsx"
      provides: "Landing page shell"
      contains: "export default"
    - path: "src/types/index.ts"
      provides: "Domain type definitions for cases, agents, audit logs, documents"
      contains: "Case"
    - path: ".env.example"
      provides: "Environment variable template"
      contains: "SUPABASE_URL"
  key_links:
    - from: "src/app/layout.tsx"
      to: "src/app/globals.css"
      via: "CSS import"
      pattern: "import.*globals.css"
    - from: "src/app/layout.tsx"
      to: "src/lib/utils.ts"
      via: "cn utility available"
      pattern: "import.*utils"
---

<objective>
Scaffold the Next.js project with all dependencies, create the full directory structure, install shadcn/ui components, define domain TypeScript types, and create the app shell layout.

Purpose: Establish the foundation that all subsequent plans build on — project structure, dependencies, types, and a running dev server.
Output: A working Next.js app with clean architecture, all deps installed, domain types defined, and a basic app shell.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Next.js project and install all dependencies</name>
  <files>
    package.json, tsconfig.json, next.config.ts, tailwind.config.ts,
    postcss.config.mjs, .gitignore, .env.local, .env.example
  </files>
  <action>
    1. Initialize Next.js project in the repo root using `npx create-next-app@latest . --typescript --tailwind --eslint --app --src-dir --import-alias "@/*" --use-npm`. If prompted about existing files, proceed (overwrite README, keep .planning/).

    2. Install all project dependencies in one command:
       ```
       npm install @supabase/supabase-js @anthropic-ai/sdk lucide-react class-variance-authority clsx tailwind-merge
       ```

    3. Install dev dependencies:
       ```
       npm install -D @types/node
       ```

    4. Initialize shadcn/ui:
       ```
       npx shadcn@latest init -d
       ```

    5. Add core shadcn components:
       ```
       npx shadcn@latest add button card badge input textarea separator scroll-area table tabs alert dialog dropdown-menu toast sonner
       ```

    6. Create `.env.example` with all required environment variables:
       ```
       # Supabase
       NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
       NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
       SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key

       # Anthropic (Claude Agent SDK)
       ANTHROPIC_API_KEY=your_anthropic_api_key

       # Mistral (OCR)
       MISTRAL_API_KEY=your_mistral_api_key
       ```

    7. Create `.env.local` by copying `.env.example` (user will fill in real values).

    8. Ensure `.gitignore` includes `.env.local` and `node_modules/`.

    9. Update `next.config.ts` — keep it minimal, no special config needed yet.
  </action>
  <verify>
    - `npm run dev` starts without errors
    - `npx tsc --noEmit` passes with no type errors
    - `.env.example` exists with all 5 env vars listed
    - `node_modules/@supabase/supabase-js` exists
    - `node_modules/@anthropic-ai/sdk` exists
    - shadcn components exist in `src/components/ui/`
  </verify>
  <done>
    Next.js project scaffolded with all dependencies installed, shadcn/ui initialized with core components, environment variable template created.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create project structure, domain types, and app shell</name>
  <files>
    src/app/layout.tsx, src/app/page.tsx, src/app/globals.css,
    src/lib/utils.ts, src/types/index.ts,
    src/lib/supabase/.gitkeep, src/lib/agents/.gitkeep,
    src/components/layout/.gitkeep
  </files>
  <action>
    1. Create directory structure (directories that don't have files yet get .gitkeep):
       ```
       src/
         app/
           api/            # API routes (will be populated in later plans)
             health/
           layout.tsx      # Root layout
           page.tsx        # Landing/dashboard page
           globals.css     # Global styles
         components/
           ui/             # shadcn components (already created)
           layout/         # Layout components (header, sidebar)
         lib/
           supabase/       # Supabase client and helpers
           agents/         # Claude Agent SDK setup
           utils.ts        # Utility functions (cn, etc.)
         types/
           index.ts        # All domain types
       ```

    2. Create `src/types/index.ts` with complete domain types for the KYC/AML system:

       ```typescript
       // Case status lifecycle
       export type CaseStatus = 'pending' | 'processing' | 'review' | 'approved' | 'denied' | 'escalated';

       // Agent types in the system
       export type AgentType = 'orchestrator' | 'document_processor' | 'identity_verifier' | 'sanctions_screener' | 'risk_scorer' | 'case_narrator';

       // Agent run status
       export type AgentRunStatus = 'pending' | 'running' | 'completed' | 'failed';

       // Document types
       export type DocumentType = 'passport' | 'drivers_license' | 'utility_bill' | 'bank_statement' | 'corporate_doc';

       // Risk levels
       export type RiskLevel = 'low' | 'medium' | 'high' | 'critical';

       // Decision types
       export type DecisionType = 'approved' | 'denied' | 'escalated';

       // Actor types for audit
       export type ActorType = 'system' | 'agent' | 'officer';

       // ---- Core Domain Models ----

       export interface Case {
         id: string;
         status: CaseStatus;
         applicant_name: string;
         applicant_email: string;
         risk_score: number | null;
         risk_level: RiskLevel | null;
         decision: DecisionType | null;
         decision_justification: string | null;
         officer_id: string | null;
         narrative: string | null;
         created_at: string;
         updated_at: string;
       }

       export interface Document {
         id: string;
         case_id: string;
         type: DocumentType;
         file_name: string;
         file_url: string;
         ocr_output: string | null;
         extracted_data: Record<string, unknown> | null;
         confidence: number | null;
         created_at: string;
       }

       export interface AgentRun {
         id: string;
         case_id: string;
         agent_type: AgentType;
         status: AgentRunStatus;
         started_at: string | null;
         completed_at: string | null;
         input: Record<string, unknown> | null;
         output: Record<string, unknown> | null;
         confidence: number | null;
         error: string | null;
         created_at: string;
       }

       export interface AuditLog {
         id: string;
         case_id: string;
         action: string;
         actor_type: ActorType;
         actor_id: string;
         details: Record<string, unknown> | null;
         created_at: string;
       }
       ```

    3. Update `src/app/layout.tsx` — clean root layout with Inter font, proper metadata:
       ```typescript
       import type { Metadata } from "next";
       import { Inter } from "next/font/google";
       import "./globals.css";
       import { cn } from "@/lib/utils";

       const inter = Inter({ subsets: ["latin"] });

       export const metadata: Metadata = {
         title: "KYC/AML Operations Orchestrator",
         description: "Multi-agent AI system for KYC/AML compliance",
       };

       export default function RootLayout({ children }: { children: React.ReactNode }) {
         return (
           <html lang="en" suppressHydrationWarning>
             <body className={cn(inter.className, "min-h-screen bg-background antialiased")}>
               {children}
             </body>
           </html>
         );
       }
       ```

    4. Update `src/app/page.tsx` — simple app shell that proves the project works:
       ```typescript
       import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
       import { Badge } from "@/components/ui/badge";

       export default function Home() {
         return (
           <main className="flex min-h-screen flex-col items-center justify-center p-8">
             <Card className="w-full max-w-lg">
               <CardHeader>
                 <div className="flex items-center gap-2">
                   <CardTitle>KYC/AML Operations Orchestrator</CardTitle>
                   <Badge variant="secondary">v0.1</Badge>
                 </div>
                 <CardDescription>
                   Multi-agent AI system for KYC/AML compliance operations
                 </CardDescription>
               </CardHeader>
               <CardContent>
                 <p className="text-sm text-muted-foreground">
                   Foundation ready. Dashboard coming soon.
                 </p>
               </CardContent>
             </Card>
           </main>
         );
       }
       ```

    5. Create `src/app/api/health/route.ts` — health check endpoint:
       ```typescript
       import { NextResponse } from "next/server";

       export async function GET() {
         return NextResponse.json({
           status: "ok",
           timestamp: new Date().toISOString(),
           version: "0.1.0",
         });
       }
       ```
  </action>
  <verify>
    - `npx tsc --noEmit` passes (all types compile)
    - `npm run dev` starts and localhost:3000 shows the app shell card
    - `curl http://localhost:3000/api/health` returns `{"status":"ok",...}`
    - `src/types/index.ts` exports Case, Document, AgentRun, AuditLog interfaces
    - Directory structure: src/app/api, src/components/ui, src/components/layout, src/lib/supabase, src/lib/agents, src/types all exist
  </verify>
  <done>
    Complete project structure created with domain types for cases, documents, agent runs, and audit logs. App shell renders at localhost:3000. Health check API responds.
  </done>
</task>

</tasks>

<verification>
1. `npm run dev` starts the dev server without errors
2. Browser at localhost:3000 shows the KYC/AML app shell card
3. `curl localhost:3000/api/health` returns JSON with status "ok"
4. `npx tsc --noEmit` passes with zero errors
5. All shadcn components present in src/components/ui/
6. Domain types compile and export correctly from src/types/index.ts
</verification>

<success_criteria>
- Next.js app runs locally with no errors (Phase 1 Success Criterion #1 partially met)
- Project structure follows clean architecture with src/app, src/components, src/lib, src/types (Phase 1 Success Criterion #4)
- All dependencies installed for Supabase, Claude SDK, Mistral, and UI
- Domain types defined for the entire KYC/AML data model
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
